import numpy as np
import matplotlib.pyplot as plt


def get_data(dataset):

  if dataset == 'Fashion_MNIST':
    data = [
      [80.18, 84.84, 86.95, 87.58], #our-dce:    [80.186±0.813, 84.846±0.242, 86.953±0.079, 87.580±0.447], w-g[80.696±0.673, 84.540±0.092, 85.430±0.145, 86.120±0.876]
      [81.07, 84.53, 86.24, 87.07], #our-ce:     [81.073±1.335, 84.536±0.584, 86.243±0.440, 87.070±0.433]
      [75.91, 79.14, 81.83, 83.78], #cope:       [75.917±0.653, 79.143±4.987, 81.837±2.786, 83.780±2.204]
      [49.21, 51.61, 50.38, 50.93], #icarl:      [49.213±1.739, 51.613±2.696, 50.380±2.098, 50.933±1.401]
      [72.61, 79.72, 83.62, 83.24], #reservoir:  [72.613±1.161, 79.723±3.010, 83.627±1.220, 83.247±0.540]
      [47.38, 67.96, 77.64, 82.46], #gss:        [47.384±4.438, 67.968±3.487, 77.647±4.181, 82.460±1.854]
      [39.69, 35.46, 32.65, 44.20], #gem:        [39.693±14.88, 35.463±0.638, 32.650±13.95, 44.207±9.255]

      [00.00, 00.00, 00.00, 00.00], #our-batch:  [58.233±5.563, 71.200±3.636, 78.100±1.469, 83.233±1.132]
      [00.00, 00.00, 00.00, 00.00], #our-rep:    [84.066±0.684, 84.366±0.411, 86.700±0.424, 88.966±0.402]
    ]
    err = [
      [0.81, 0.24, 0.07, 0.44],
      [1.33, 0.58, 0.44, 0.43],
      [0.65, 4.98, 2.78, 2.20],
      [1.73, 2.69, 2.09, 1.40],
      [1.16, 3.01, 1.22, 0.54],
      [4.43, 3.48, 4.18, 1.85],
      [0.00, 0.00, 0.00, 0.00],
    ]
    data_mean = [
      '84.88±2.90',
      '84.73±2.30',
      '80.16±2.95',
      '50.53±0.87',
      '79.79±4.41',
      '68.86±13.45',
      '38.00±4.37'
    ]

  elif dataset == 'CIFAR10':
    data = [
      [42.26, 50.82, 56.34, 60.94], #our:      [42.266±0.679, 50.826±0.804, 56.339±1.308, 60.940±1.016]
      [42.95, 50.96, 57.75, 61.90], #our-ce:   [42.950±0.355, 50.966±0.865, 57.756±0.638, 61.900±1.369]
      [29.47, 33.92, 30.99, 26.80], #cope:     [29.474±5.270, 33.925±1.745, 30.993±1.126, 26.805±7.300]
      [22.92, 19.93, 18.99, 25.64], #icarl:    [22.929±2.116, 19.939±2.744, 18.993±2.309, 25.643±2.631]
      [37.06, 46.06, 46.74, 49.89], #reservoir:[37.063±0.489, 46.064±6.203, 46.748±15.31, 49.895±5.801]
      [28.48, 21.89, 31.29, 35.22], #gss:      [28.483±1.117, 21.890±19.332, 31.294±11.237, 35.222±7.127]
      [00.00, 00.00, 00.00, 00.00]  #gem:      [00.000±0.000, 00.000±0.000, 00.000±0.000, 00.000±0.000-> failed] 
    ]
    err = [
      [0.68, 0.80, 1.30, 1.01],
      [0.35, 0.86, 0.63, 1.37],
      [5.27, 1.74, 1.12, 7.30],
      [2.11, 2.74, 2.30, 2.63],
      [0.49, 6.20, 15.3, 5.80],
      [1.11, 19.3, 11.2, 7.12],
      [0.00, 0.00, 0.00, 0.00],
    ]
    data_mean = [
      '52.59±6.95',
      '53.39±7.18',
      '30.29±2.57',
      '21.87±2.61',
      '44.93±4.77',
      '29.22±4.86',
      '00.00±0.00',
    ]

  return data, data_mean, err



def main():
  dataset = 'CIFAR10' #['Fashion_MNIST', 'CIFAR10']
  data, data_mean, err = get_data(dataset)
  methods = ['our', 'our-ce', 'CoPE', 'iCaRL', 'reservoir', 'GSS']
  colors = ['royalblue', 'hotpink', 'blueviolet', 'gold', 'darkorange', 'limegreen']
  N = 4
  ind = np.arange(N)  # the x locations for the groups
  width = 0.1
  
  fig = plt.figure()
  ax = fig.add_subplot(111)
  
  for i in range(6):
    index = ind + (i-2.5)*width 
    ax.bar(
      index,
      data[i],
      yerr=err[i],
      color=colors[i],
      width=width,
      align='center',
      label='{}: {}'.format(methods[i], data_mean[i])
    )

  ax.set_xticks(ind)
  ax.set_xticklabels(['0.2k', '0.5k', '1k', '2k'])
  ax.set_xlabel('Memory size')
  ax.set_ylabel('Accuracy (%)')

  if dataset == 'Fashion_MNIST':
    ax.set_ylim([40, 100])
  elif dataset == 'CIFAR10':
    ax.set_ylim([0, 70])

  ax.set_title('Split-{}'.format(dataset), pad=32.0)

  ax.legend()
  ax.legend(loc='lower left', bbox_to_anchor=(0, 1.0, 1.2, 0.2),
          fancybox=True, shadow=False, ncol=3, fontsize=8)

  plt.show()

if __name__ == '__main__':
  main()